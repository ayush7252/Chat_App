{"ast":null,"code":"import _taggedTemplateLiteral from\"C:/Users/ayush/Downloads/Chat-App/frontend/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";import _asyncToGenerator from\"C:/Users/ayush/Downloads/Chat-App/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/ayush/Downloads/Chat-App/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";var _templateObject;import _regeneratorRuntime from\"C:\\\\Users\\\\ayush\\\\Downloads\\\\Chat-App\\\\frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useEffect,useState,useRef}from\"react\";import axios from\"axios\";import{useNavigate}from\"react-router-dom\";import{io}from\"socket.io-client\";import styled from\"styled-components\";import{allUsersRoute,host}from\"../utils/APIRoutes\";import ChatContainer from\"../components/ChatContainer\";import Contacts from\"../components/Contacts\";import Welcome from\"../components/Welcome\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function Chat(){var navigate=useNavigate();var socket=useRef();var _useState=useState([]),_useState2=_slicedToArray(_useState,2),contacts=_useState2[0],setContacts=_useState2[1];var _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),currentChat=_useState4[0],setCurrentChat=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),currentUser=_useState6[0],setCurrentUser=_useState6[1];useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(localStorage.getItem(process.env.REACT_APP_LOCALHOST_KEY)){_context.next=4;break;}navigate(\"/login\");_context.next=9;break;case 4:_context.t0=setCurrentUser;_context.next=7;return JSON.parse(localStorage.getItem(process.env.REACT_APP_LOCALHOST_KEY));case 7:_context.t1=_context.sent;(0,_context.t0)(_context.t1);case 9:case\"end\":return _context.stop();}}},_callee);})),[]);useEffect(function(){if(currentUser){socket.current=io(host);socket.current.emit(\"add-user\",currentUser._id);}},[currentUser]);useEffect(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!currentUser){_context2.next=9;break;}if(!currentUser.isAvatarImageSet){_context2.next=8;break;}_context2.next=4;return axios.get(\"\".concat(allUsersRoute,\"/\").concat(currentUser._id));case 4:data=_context2.sent;setContacts(data.data);_context2.next=9;break;case 8:navigate(\"/setAvatar\");case 9:case\"end\":return _context2.stop();}}},_callee2);})),[currentUser]);var handleChatChange=function handleChatChange(chat){setCurrentChat(chat);};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(Contacts,{contacts:contacts,changeChat:handleChatChange}),currentChat===undefined?/*#__PURE__*/_jsx(Welcome,{}):/*#__PURE__*/_jsx(ChatContainer,{currentChat:currentChat,socket:socket})]})})});}var Container=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  height: 100vh;\\n  width: 100vw;\\n  display: flex;\\n  flex-direction: column;\\n  justify-content: center;\\n  gap: 1rem;\\n  align-items: center;\\n  background-color: #131324;\\n  .container {\\n    height: 85vh;\\n    width: 85vw;\\n    background-color: #00000076;\\n    display: grid;\\n    grid-template-columns: 25% 75%;\\n    @media screen and (min-width: 720px) and (max-width: 1080px) {\\n      grid-template-columns: 35% 65%;\\n    }\\n  }\\n\"])));","map":{"version":3,"names":["React","useEffect","useState","useRef","axios","useNavigate","io","styled","allUsersRoute","host","ChatContainer","Contacts","Welcome","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Chat","navigate","socket","_useState","_useState2","_slicedToArray","contacts","setContacts","_useState3","undefined","_useState4","currentChat","setCurrentChat","_useState5","_useState6","currentUser","setCurrentUser","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","localStorage","getItem","process","env","REACT_APP_LOCALHOST_KEY","t0","JSON","parse","t1","sent","stop","current","emit","_id","_callee2","data","_callee2$","_context2","isAvatarImageSet","get","concat","handleChatChange","chat","children","Container","className","changeChat","div","_templateObject","_taggedTemplateLiteral"],"sources":["C:/Users/ayush/Downloads/Chat-App/frontend/src/pages/Chat.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from \"react\";\nimport axios from \"axios\";\nimport { useNavigate } from \"react-router-dom\";\nimport { io } from \"socket.io-client\";\nimport styled from \"styled-components\";\nimport { allUsersRoute, host } from \"../utils/APIRoutes\";\nimport ChatContainer from \"../components/ChatContainer\";\nimport Contacts from \"../components/Contacts\";\nimport Welcome from \"../components/Welcome\";\n\nexport default function Chat() {\n  const navigate = useNavigate();\n  const socket = useRef();\n  const [contacts, setContacts] = useState([]);\n  const [currentChat, setCurrentChat] = useState(undefined);\n  const [currentUser, setCurrentUser] = useState(undefined);\n  useEffect(async () => {\n    if (!localStorage.getItem(process.env.REACT_APP_LOCALHOST_KEY)) {\n      navigate(\"/login\");\n    } else {\n      setCurrentUser(\n        await JSON.parse(\n          localStorage.getItem(process.env.REACT_APP_LOCALHOST_KEY)\n        )\n      );\n    }\n  }, []);\n  useEffect(() => {\n    if (currentUser) {\n      socket.current = io(host);\n      socket.current.emit(\"add-user\", currentUser._id);\n    }\n  }, [currentUser]);\n\n  useEffect(async () => {\n    if (currentUser) {\n      if (currentUser.isAvatarImageSet) {\n        const data = await axios.get(`${allUsersRoute}/${currentUser._id}`);\n        setContacts(data.data);\n      } else {\n        navigate(\"/setAvatar\");\n      }\n    }\n  }, [currentUser]);\n  const handleChatChange = (chat) => {\n    setCurrentChat(chat);\n  };\n  return (\n    <>\n      <Container>\n        <div className=\"container\">\n          <Contacts contacts={contacts} changeChat={handleChatChange} />\n          {currentChat === undefined ? (\n            <Welcome />\n          ) : (\n            <ChatContainer currentChat={currentChat} socket={socket} />\n          )}\n        </div>\n      </Container>\n    </>\n  );\n}\n\nconst Container = styled.div`\n  height: 100vh;\n  width: 100vw;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  gap: 1rem;\n  align-items: center;\n  background-color: #131324;\n  .container {\n    height: 85vh;\n    width: 85vw;\n    background-color: #00000076;\n    display: grid;\n    grid-template-columns: 25% 75%;\n    @media screen and (min-width: 720px) and (max-width: 1080px) {\n      grid-template-columns: 35% 65%;\n    }\n  }\n`;\n"],"mappings":"ijBAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,CAAEC,MAAM,KAAQ,OAAO,CAC1D,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,EAAE,KAAQ,kBAAkB,CACrC,MAAO,CAAAC,MAAM,KAAM,mBAAmB,CACtC,OAASC,aAAa,CAAEC,IAAI,KAAQ,oBAAoB,CACxD,MAAO,CAAAC,aAAa,KAAM,6BAA6B,CACvD,MAAO,CAAAC,QAAQ,KAAM,wBAAwB,CAC7C,MAAO,CAAAC,OAAO,KAAM,uBAAuB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAE5C,cAAe,SAAS,CAAAC,IAAIA,CAAA,CAAG,CAC7B,GAAM,CAAAC,QAAQ,CAAGf,WAAW,CAAC,CAAC,CAC9B,GAAM,CAAAgB,MAAM,CAAGlB,MAAM,CAAC,CAAC,CACvB,IAAAmB,SAAA,CAAgCpB,QAAQ,CAAC,EAAE,CAAC,CAAAqB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAArCG,QAAQ,CAAAF,UAAA,IAAEG,WAAW,CAAAH,UAAA,IAC5B,IAAAI,UAAA,CAAsCzB,QAAQ,CAAC0B,SAAS,CAAC,CAAAC,UAAA,CAAAL,cAAA,CAAAG,UAAA,IAAlDG,WAAW,CAAAD,UAAA,IAAEE,cAAc,CAAAF,UAAA,IAClC,IAAAG,UAAA,CAAsC9B,QAAQ,CAAC0B,SAAS,CAAC,CAAAK,UAAA,CAAAT,cAAA,CAAAQ,UAAA,IAAlDE,WAAW,CAAAD,UAAA,IAAEE,cAAc,CAAAF,UAAA,IAClChC,SAAS,cAAAmC,iBAAA,cAAAC,mBAAA,CAAAC,IAAA,CAAC,SAAAC,QAAA,SAAAF,mBAAA,CAAAG,IAAA,UAAAC,SAAAC,QAAA,kBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,YACHC,YAAY,CAACC,OAAO,CAACC,OAAO,CAACC,GAAG,CAACC,uBAAuB,CAAC,EAAAP,QAAA,CAAAE,IAAA,UAC5DxB,QAAQ,CAAC,QAAQ,CAAC,CAACsB,QAAA,CAAAE,IAAA,gBAAAF,QAAA,CAAAQ,EAAA,CAEnBf,cAAc,CAAAO,QAAA,CAAAE,IAAA,SACN,CAAAO,IAAI,CAACC,KAAK,CACdP,YAAY,CAACC,OAAO,CAACC,OAAO,CAACC,GAAG,CAACC,uBAAuB,CAC1D,CAAC,QAAAP,QAAA,CAAAW,EAAA,CAAAX,QAAA,CAAAY,IAAA,IAAAZ,QAAA,CAAAQ,EAAA,EAAAR,QAAA,CAAAW,EAAA,0BAAAX,QAAA,CAAAa,IAAA,OAAAhB,OAAA,GAGN,GAAE,EAAE,CAAC,CACNtC,SAAS,CAAC,UAAM,CACd,GAAIiC,WAAW,CAAE,CACfb,MAAM,CAACmC,OAAO,CAAGlD,EAAE,CAACG,IAAI,CAAC,CACzBY,MAAM,CAACmC,OAAO,CAACC,IAAI,CAAC,UAAU,CAAEvB,WAAW,CAACwB,GAAG,CAAC,CAClD,CACF,CAAC,CAAE,CAACxB,WAAW,CAAC,CAAC,CAEjBjC,SAAS,cAAAmC,iBAAA,cAAAC,mBAAA,CAAAC,IAAA,CAAC,SAAAqB,SAAA,MAAAC,IAAA,QAAAvB,mBAAA,CAAAG,IAAA,UAAAqB,UAAAC,SAAA,kBAAAA,SAAA,CAAAnB,IAAA,CAAAmB,SAAA,CAAAlB,IAAA,aACJV,WAAW,EAAA4B,SAAA,CAAAlB,IAAA,cACTV,WAAW,CAAC6B,gBAAgB,EAAAD,SAAA,CAAAlB,IAAA,UAAAkB,SAAA,CAAAlB,IAAA,SACX,CAAAxC,KAAK,CAAC4D,GAAG,IAAAC,MAAA,CAAIzD,aAAa,MAAAyD,MAAA,CAAI/B,WAAW,CAACwB,GAAG,CAAE,CAAC,QAA7DE,IAAI,CAAAE,SAAA,CAAAR,IAAA,CACV5B,WAAW,CAACkC,IAAI,CAACA,IAAI,CAAC,CAACE,SAAA,CAAAlB,IAAA,gBAEvBxB,QAAQ,CAAC,YAAY,CAAC,CAAC,wBAAA0C,SAAA,CAAAP,IAAA,OAAAI,QAAA,GAG5B,GAAE,CAACzB,WAAW,CAAC,CAAC,CACjB,GAAM,CAAAgC,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAIC,IAAI,CAAK,CACjCpC,cAAc,CAACoC,IAAI,CAAC,CACtB,CAAC,CACD,mBACErD,IAAA,CAAAI,SAAA,EAAAkD,QAAA,cACEtD,IAAA,CAACuD,SAAS,EAAAD,QAAA,cACRpD,KAAA,QAAKsD,SAAS,CAAC,WAAW,CAAAF,QAAA,eACxBtD,IAAA,CAACH,QAAQ,EAACc,QAAQ,CAAEA,QAAS,CAAC8C,UAAU,CAAEL,gBAAiB,CAAE,CAAC,CAC7DpC,WAAW,GAAKF,SAAS,cACxBd,IAAA,CAACF,OAAO,GAAE,CAAC,cAEXE,IAAA,CAACJ,aAAa,EAACoB,WAAW,CAAEA,WAAY,CAACT,MAAM,CAAEA,MAAO,CAAE,CAC3D,EACE,CAAC,CACG,CAAC,CACZ,CAAC,CAEP,CAEA,GAAM,CAAAgD,SAAS,CAAG9D,MAAM,CAACiE,GAAG,CAAAC,eAAA,GAAAA,eAAA,CAAAC,sBAAA,icAmB3B","ignoreList":[]},"metadata":{},"sourceType":"module"}